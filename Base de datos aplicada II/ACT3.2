CASO-3
VAR B_PAT VARCHAR2
EXEC :B_PAT:='VR1003';
DECLARE 
    V_PATENTE ARRIENDO_CAMION.NRO_PATENTE%TYPE;
    V_VDIA CAMION.VALOR_ARRIENDO_DIA%TYPE;
    V_VGA CAMION.VALOR_GARANTIA_DIA%TYPE;
    V_CANTIDAD HIST_ARRIENDO_ANUAL_CAMION.TOTAL_VECES_ARRENDADO%TYPE;
BEGIN
SELECT AC.NRO_PATENTE,
C.VALOR_ARRIENDO_DIA,
C.VALOR_GARANTIA_DIA,
COUNT(AC.NRO_PATENTE)
INTO V_PATENTE, V_VDIA, V_VGA, V_CANTIDAD
from ARRIENDO_CAMION AC
INNER JOIN CAMION C ON (AC.NRO_PATENTE = C.NRO_PATENTE)
WHERE AC.NRO_PATENTE = 'VR1003' AND 
TO_CHAR(AC.FECHA_INI_ARRIENDO,'YYYY') = TO_CHAR(SYSDATE,'YYYY')-1
GROUP BY AC.NRO_PATENTE, C.VALOR_ARRIENDO_DIA, C.VALOR_GARANTIA_DIA ;

INSERT INTO HIST_ARRIENDO_ANUAL_CAMION
VALUES(TO_CHAR(SYSDATE,'YYYY'),V_PATENTE,V_VDIA,V_VGA,V_CANTIDAD);
COMMIT;

IF(V_CANTIDAD<5)THEN
    V_VDIA:=V_VDIA-V_VDIA*(22.5/100);
    V_VGA:=V_VGA-V_VGA*(22.5/100);
    
    UPDATE CAMION SET VALOR_ARRIENDO_DIA=V_VDIA,
    VALOR_GARANTIA_DIA=V_VGA
    WHERE NRO_PATENTE=:B_PAT;
    COMMIT;
ELSE
    V_VDIA:=V_VDIA;
    V_VGA:=V_VGA;
END IF;
END;
